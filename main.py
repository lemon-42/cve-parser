# Note: You may need to change the path to python3 depending on your system

#!/opt/homebrew/bin/python3

import requests
import sys
from bs4 import BeautifulSoup

# Get CVE data from cve.mitre.org

def get_cve_data(cve_id):
    url = 'https://cve.mitre.org/cgi-bin/cvename.cgi?name=' + cve_id
    response = requests.get(url)
    return response.text

# Parse the CVE data using BeautifulSoup and get the description

def parse_cve_data(cve_data):
    soup = BeautifulSoup(cve_data, 'html.parser')
    cve_description = soup.find_all('th')[1].text.strip() + '\n' +(' ').join(soup.find_all('td')[10].text.strip().split()) 
    return cve_description

# Write the description to a file

def write_to_file(cve_description):
    with open('CVE.txt', 'w') as f:
        f.write(cve_description)

# Main function

def main():
    cve_id = sys.argv[1]
    cve_data = get_cve_data(cve_id)
    cve_description = parse_cve_data(cve_data)
    write_to_file(cve_description)

if __name__ == '__main__':
    main()